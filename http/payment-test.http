### ===============================================
### ğŸ§ª í† ìŠ¤ í˜ì´ë¨¼ì¸  ë°±ì—”ë“œ í†µí•© í…ŒìŠ¤íŠ¸
### ===============================================
### âœ¨ ê°œì„ ì‚¬í•­:
### - confirmPaymentì—ì„œ ê²°ì œ ìŠ¹ì¸ + ì£¼ë¬¸ ì²˜ë¦¬ê°€ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì²˜ë¦¬
### - ë©±ë“±ì„± ë³´ì¥ (ì¤‘ë³µ ê²°ì œ ë°©ì§€)
### - ê¸ˆì•¡ ê²€ì¦ ì¶”ê°€
### - ì¬ê³  ë¶€ì¡± ì˜ˆì™¸ ì²˜ë¦¬
### ===============================================

### ===============================================
### STEP 1: ì´ˆê¸° ë°ì´í„° ìƒì„±
### ===============================================

### 1-1. ì¹´í…Œê³ ë¦¬ ìƒì„±
POST http://localhost:8080/v1/categories
Content-Type: application/json
X-MEMBER-ID: admin@test.com
ROLE: ADMIN

{
  "categoryName": "ì˜ë¥˜",
  "categoryLevel": 1
}

###

### 1-2. ì œí’ˆ ë“±ë¡
POST http://localhost:8080/v1/products
Content-Type: application/json
X-MEMBER-ID: admin@test.com
ROLE: ADMIN

{
  "name": "ê²¨ìš¸ ìš¸ ë‹ˆíŠ¸",
  "description": "ë”°ëœ»í•œ ê²¨ìš¸ ìš¸ ë‹ˆíŠ¸ì…ë‹ˆë‹¤.",
  "categoryId": 1,
  "price": 50000,
  "summaryDescription": "ë”°ëœ»í•œ ê²¨ìš¸ ë‹ˆíŠ¸",
  "simpleDescription": "ë©”ë¦¬ë…¸ ìš¸ 100%",
  "productOptions": [
    {
      "productOptionName": "ë² ì´ì§€/M",
      "productOptionDetails": [
        {
          "productOptionType": "ìƒ‰ìƒ",
          "productOptionDetailName": "ë² ì´ì§€"
        },
        {
          "productOptionType": "ì‚¬ì´ì¦ˆ",
          "productOptionDetailName": "M"
        }
      ],
      "stockQuantity": 100,
      "additionalPrice": 0
    }
  ],
  "thumbnail": "/images/knitwear.jpg",
  "productImages": {
    "paths": ["/images/knitwear-1.jpg"]
  },
  "tags": [
    {"tagName": "ê²¨ìš¸ì‹ ìƒ"}
  ]
}

###

### 1-3. íšŒì› ìƒì„±
POST http://localhost:8080/v1/members
Content-Type: application/json

{
  "memberId": "test@test.com",
  "password": "test1234!",
  "name": "í…ŒìŠ¤íŠ¸ì‚¬ìš©ì",
  "birthday": "1990-01-01",
  "phoneNumber": "010-1234-5678",
  "gender": "M",
  "tosAgreement": true,
  "privacyAgreement": true,
  "marketingAgreement": false
}

###

### ===============================================
### STEP 2: ì£¼ë¬¸ ìƒì„±
### ===============================================

POST http://localhost:8080/v1/orders
Content-Type: application/json
X-MEMBER-ID: test@test.com

{
  "addressInfo": {
    "address1": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123",
    "address2": "í…ŒìŠ¤íŠ¸ë¹Œë”© 10ì¸µ",
    "postalCode": "06234",
    "receiver": "í…ŒìŠ¤íŠ¸ì‚¬ìš©ì",
    "phoneNumber": "010-1234-5678",
    "email": "test@test.com"
  },
  "items": [
    {
      "productId": 1,
      "productOptionId": 1,
      "quantity": 2
    }
  ],
  "paymentMethod": "CARD",
  "orderDiscount": {
    "couponId": null,
    "points": 0
  },
  "orderDetail": {
    "originalTotal": 100000,
    "discountedTotal": 100000,
    "productDiscount": 0,
    "additionalDiscount": 0,
    "shippingFee": 3000,
    "finalAmount": 103000
  }
}

### âš ï¸ ì¤‘ìš”: ì‘ë‹µì—ì„œ ë‹¤ìŒ ì •ë³´ë¥¼ ë³µì‚¬í•˜ì„¸ìš”!
### - orderNumber: "ORD20260120..." â† ê²°ì œ ìŠ¹ì¸ì— í•„ìš”
### - totalPrice: 103000 â† ê¸ˆì•¡ ê²€ì¦ì— í•„ìš”
###
### ğŸ“ ë³µì‚¬í•œ ì •ë³´:
### orderNumber: ___________________
### totalPrice: ___________________

###

### ===============================================
### STEP 3: ê²°ì œ ì „ ìƒíƒœ í™•ì¸
### ===============================================

### 3-1. ì£¼ë¬¸ ìƒíƒœ í™•ì¸
GET http://localhost:8080/v1/orders/1
X-MEMBER-ID: test@test.com

### âœ… í™•ì¸: orderStatus = "PAYMENT_PENDING"

###

### 3-2. ìƒí’ˆ ì¬ê³  í™•ì¸
GET http://localhost:8080/v1/products/1

### âœ… í™•ì¸: stockQuantity = 100 (ì•„ì§ ì°¨ê° ì•ˆë¨)

###

### ===============================================
### STEP 4: ê²°ì œ ìŠ¹ì¸ (í†µí•© ì²˜ë¦¬)
### ===============================================

### 4-1. ê²°ì œ ìŠ¹ì¸ + ì£¼ë¬¸ ì²˜ë¦¬ (í•˜ë‚˜ì˜ APIë¡œ í†µí•©!)
### âš ï¸ orderIdì™€ amountë¥¼ ìœ„ì—ì„œ ë³µì‚¬í•œ ê°’ìœ¼ë¡œ ë³€ê²½í•˜ì„¸ìš”!
POST http://localhost:8080/v1/payments/confirm
Content-Type: application/json

{
  "paymentKey": "test_payment_key_12345",
  "orderId": "ORD20260120183025456",
  "amount": 103000
}

### âœ… ì˜ˆìƒ ê²°ê³¼:
### - í† ìŠ¤ API í˜¸ì¶œ (í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œëŠ” ì‹¤íŒ¨í•  ìˆ˜ ìˆìŒ)
### - ì£¼ë¬¸ ìƒíƒœ: PAYMENT_PENDING â†’ PAYMENT_COMPLETED
### - ì£¼ë¬¸ìƒí’ˆ ìƒíƒœ: PAYMENT_PENDING â†’ PAYMENT_COMPLETED
### - ì¬ê³ : 100 â†’ 98 (2ê°œ ì°¨ê°)

###

### ===============================================
### STEP 5: ê²°ì œ í›„ ìƒíƒœ í™•ì¸
### ===============================================

### 5-1. ì£¼ë¬¸ ìƒíƒœ í™•ì¸
GET http://localhost:8080/v1/orders/1
X-MEMBER-ID: test@test.com

### âœ… í™•ì¸:
### - orderStatus: "PAYMENT_COMPLETED" â† ë³€ê²½ë¨!
### - orderProducts[].orderProductStatus: "PAYMENT_COMPLETED" â† ë³€ê²½ë¨!

###

### 5-2. ìƒí’ˆ ì¬ê³  í™•ì¸
GET http://localhost:8080/v1/products/1

### âœ… í™•ì¸:
### - productOptions[0].stockQuantity: 98 â† ì°¨ê°ë¨! (100 - 2)

###

### 5-3. ë‚´ ì£¼ë¬¸ ëª©ë¡ ì¡°íšŒ
POST http://localhost:8080/v1/orders/search
Content-Type: application/json
X-MEMBER-ID: test@test.com

{
  "conditions": {
    "type": "ALL",
    "status": null,
    "startDate": "2025-01-01",
    "endDate": "2026-12-31"
  },
  "pageable": {
    "page": 0,
    "size": 10,
    "sort": {
      "direction": "DESC",
      "properties": ["orderDate"]
    }
  }
}

###

### ===============================================
### BONUS 1: ë©±ë“±ì„± í…ŒìŠ¤íŠ¸ (ì¤‘ë³µ ê²°ì œ ë°©ì§€)
### ===============================================

### 6-1. ë™ì¼í•œ ì£¼ë¬¸ì— ëŒ€í•´ ë‹¤ì‹œ ê²°ì œ ì‹œë„
### âš ï¸ orderIdë¥¼ ì´ë¯¸ ê²°ì œ ì™„ë£Œí•œ ì£¼ë¬¸ë²ˆí˜¸ë¡œ ì„¤ì •
POST http://localhost:8080/v1/payments/confirm
Content-Type: application/json

{
  "paymentKey": "test_payment_key_67890",
  "orderId": "ORD20260120183025456",
  "amount": 103000
}

### âœ… ì˜ˆìƒ ì‘ë‹µ:
### {
###   "status": "ALREADY_COMPLETED",
###   "message": "ì´ë¯¸ ê²°ì œê°€ ì™„ë£Œëœ ì£¼ë¬¸ì…ë‹ˆë‹¤.",
###   "orderNumber": "ORD20260120183025456"
### }

###

### ===============================================
### BONUS 2: ê¸ˆì•¡ ë¶ˆì¼ì¹˜ í…ŒìŠ¤íŠ¸
### ===============================================

### 6-2. ì˜ëª»ëœ ê¸ˆì•¡ìœ¼ë¡œ ê²°ì œ ì‹œë„
POST http://localhost:8080/v1/payments/confirm
Content-Type: application/json

{
  "paymentKey": "test_payment_key_99999",
  "orderId": "ORD20260120183025456",
  "amount": 999999
}

### âœ… ì˜ˆìƒ ì‘ë‹µ: 400 Bad Request
### {
###   "error": "ê²°ì œ ê¸ˆì•¡ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ì£¼ë¬¸ê¸ˆì•¡: 103000, ê²°ì œê¸ˆì•¡: 999999"
### }

###

### ===============================================
### BONUS 3: ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì£¼ë¬¸ í…ŒìŠ¤íŠ¸
### ===============================================

### 6-3. ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì£¼ë¬¸ë²ˆí˜¸ë¡œ ê²°ì œ ì‹œë„
POST http://localhost:8080/v1/payments/confirm
Content-Type: application/json

{
  "paymentKey": "test_payment_key_00000",
  "orderId": "ORD99999999999999",
  "amount": 100000
}

### âœ… ì˜ˆìƒ ì‘ë‹µ: 400 Bad Request
### {
###   "error": "ì£¼ë¬¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤: ORD99999999999999"
### }

###

### ===============================================
### BONUS 4: ì¬ê³  ë¶€ì¡± í…ŒìŠ¤íŠ¸
### ===============================================

### 6-4. ì¬ê³ ë¥¼ ì´ˆê³¼í•˜ëŠ” ì£¼ë¬¸ ìƒì„± í›„ ê²°ì œ
POST http://localhost:8080/v1/orders
Content-Type: application/json
X-MEMBER-ID: test@test.com

{
  "addressInfo": {
    "address1": "ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬",
    "address2": "í…ŒìŠ¤íŠ¸",
    "postalCode": "06234",
    "receiver": "í…ŒìŠ¤íŠ¸",
    "phoneNumber": "010-1234-5678",
    "email": "test@test.com"
  },
  "items": [
    {
      "productId": 1,
      "productOptionId": 1,
      "quantity": 200
    }
  ],
  "paymentMethod": "CARD",
  "orderDiscount": {
    "couponId": null,
    "points": 0
  },
  "orderDetail": {
    "originalTotal": 10000000,
    "discountedTotal": 10000000,
    "productDiscount": 0,
    "additionalDiscount": 0,
    "shippingFee": 3000,
    "finalAmount": 10003000
  }
}

### ì£¼ë¬¸ì€ ìƒì„±ë˜ì§€ë§Œ, ê²°ì œ ì‹œ ì¬ê³  ë¶€ì¡±ìœ¼ë¡œ ì‹¤íŒ¨í•´ì•¼ í•¨

POST http://localhost:8080/v1/payments/confirm
Content-Type: application/json

{
  "paymentKey": "test_payment_key_stock",
  "orderId": "ìœ„ì—ì„œ_ë°›ì€_orderNumber",
  "amount": 10003000
}

### âœ… ì˜ˆìƒ: 500 Internal Server Error
### {
###   "error": "ì¬ê³ ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. í˜„ì¬ ì¬ê³ : 98, ìš”ì²­ ìˆ˜ëŸ‰: 200"
### }

###

### ===============================================
### í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ ì¡°íšŒ
### ===============================================

GET http://localhost:8080/v1/payments/test/guide

###

### ===============================================
### ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ì²´í¬ë¦¬ìŠ¤íŠ¸
### ===============================================
###
### âœ… STEP 1: ì´ˆê¸° ë°ì´í„° ìƒì„±
### [ ] ì¹´í…Œê³ ë¦¬ ìƒì„± ì„±ê³µ
### [ ] ì œí’ˆ ë“±ë¡ ì„±ê³µ (stockQuantity: 100)
### [ ] íšŒì› ìƒì„± ì„±ê³µ
###
### âœ… STEP 2: ì£¼ë¬¸ ìƒì„±
### [ ] ì£¼ë¬¸ ìƒì„± ì„±ê³µ
### [ ] orderNumber í™•ì¸ ë° ë³µì‚¬
### [ ] totalPrice í™•ì¸ ë° ë³µì‚¬
### [ ] orderStatus: "PAYMENT_PENDING"
###
### âœ… STEP 3: ê²°ì œ ì „ ìƒíƒœ
### [ ] ì£¼ë¬¸ ìƒíƒœ: PAYMENT_PENDING
### [ ] ì¬ê³ : 100 (ì°¨ê° ì•ˆë¨)
###
### âœ… STEP 4: ê²°ì œ ìŠ¹ì¸ (í†µí•© ì²˜ë¦¬)
### [ ] ê²°ì œ ìŠ¹ì¸ ì„±ê³µ (200 OK)
### [ ] í† ìŠ¤ API í˜¸ì¶œ ë¡œê·¸ í™•ì¸
### [ ] ì£¼ë¬¸ ì²˜ë¦¬ ë¡œê·¸ í™•ì¸
###
### âœ… STEP 5: ê²°ì œ í›„ ìƒíƒœ
### [ ] ì£¼ë¬¸ ìƒíƒœ: PAYMENT_COMPLETED âœ…
### [ ] ì£¼ë¬¸ìƒí’ˆ ìƒíƒœ: PAYMENT_COMPLETED âœ…
### [ ] ì¬ê³ : 98 (2ê°œ ì°¨ê°) âœ…
### [ ] ë‚´ ì£¼ë¬¸ ëª©ë¡ì— í‘œì‹œ âœ…
###
### âœ… BONUS: ì—ëŸ¬ ì¼€ì´ìŠ¤
### [ ] ì¤‘ë³µ ê²°ì œ ë°©ì§€ í™•ì¸ (ALREADY_COMPLETED)
### [ ] ê¸ˆì•¡ ë¶ˆì¼ì¹˜ ê²€ì¦ í™•ì¸
### [ ] ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì£¼ë¬¸ ì—ëŸ¬ ì²˜ë¦¬
### [ ] ì¬ê³  ë¶€ì¡± ì—ëŸ¬ ì²˜ë¦¬
###
### ===============================================
### ğŸ¯ ê°œì„ ì‚¬í•­ ìš”ì•½
### ===============================================
###
### âœ¨ Before (ê¸°ì¡´):
### 1. confirmPayment() - í† ìŠ¤ API í˜¸ì¶œ
### 2. processPaymentSuccess() - ì£¼ë¬¸ ì²˜ë¦¬ (ë³„ë„ í˜¸ì¶œ)
### â†’ ë‘ ë©”ì„œë“œê°€ ë¶„ë¦¬ë˜ì–´ ìˆì–´ ì—ëŸ¬ ê°€ëŠ¥ì„± ë†’ìŒ
###
### âœ¨ After (ê°œì„ ):
### 1. confirmPayment() - í† ìŠ¤ API + ì£¼ë¬¸ ì²˜ë¦¬ í†µí•©
### â†’ í•˜ë‚˜ì˜ íŠ¸ëœì­ì…˜ìœ¼ë¡œ ì›ìì„± ë³´ì¥
###
### ì¥ì :
### âœ… íŠ¸ëœì­ì…˜ ë³´ì¥ (ê²°ì œ ì„±ê³µ = ì£¼ë¬¸ ì²˜ë¦¬ ì™„ë£Œ)
### âœ… ë©±ë“±ì„± ë³´ì¥ (ì¤‘ë³µ ê²°ì œ ë°©ì§€)
### âœ… ê¸ˆì•¡ ê²€ì¦ (ì£¼ë¬¸ ê¸ˆì•¡ != ê²°ì œ ê¸ˆì•¡ ì‹œ ì—ëŸ¬)
### âœ… ì¬ê³  ê²€ì¦ (ì¬ê³  ë¶€ì¡± ì‹œ ì—ëŸ¬)
### âœ… ì½”ë“œ ê°„ì†Œí™” (ìœ ì§€ë³´ìˆ˜ ìš©ì´)
###
### ===============================================
